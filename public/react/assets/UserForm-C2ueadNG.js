import{c as y,b as k,r as i,i as x,j as e}from"./index-DVRvRvoE.js";import{F as E}from"./ArrowLeftIcon-DnEIe2bt.js";const C={name:"",email:"",password:"",password_confirmation:"",role:"user"},U=()=>{const l=y(),{id:d}=k(),n=!!d,[s,f]=i.useState(C),[j,h]=i.useState(!1),[w,b]=i.useState(!1),[t,u]=i.useState({});i.useEffect(()=>{n&&g()},[d]);const g=async()=>{h(!0);try{const a=await x.getOne(d),r=a.data?.data||a.data;f({name:r.name||"",email:r.email||"",password:"",password_confirmation:"",role:r.role||"user"})}catch(a){console.error("Error fetching user:",a),alert("Failed to load user"),l("/admin/users")}finally{h(!1)}},m=a=>{const{name:r,value:c}=a.target;f(o=>({...o,[r]:c})),t[r]&&u(o=>({...o,[r]:""}))},v=()=>{const a={};return s.name.trim()||(a.name="Name is required"),s.email.trim()||(a.email="Email is required"),!n&&!s.password&&(a.password="Password is required"),s.password&&s.password.length<8&&(a.password="Password must be at least 8 characters"),s.password&&s.password!==s.password_confirmation&&(a.password_confirmation="Passwords do not match"),u(a),Object.keys(a).length===0},N=async a=>{if(a.preventDefault(),!!v()){b(!0);try{const r={name:s.name,email:s.email};s.password&&(r.password=s.password,r.password_confirmation=s.password_confirmation),n?await x.update(d,r):await x.create(r),l("/admin/users")}catch(r){if(console.error("Error saving user:",r),r.response?.data?.errors){const c={};Object.entries(r.response.data.errors).forEach(([o,p])=>{c[o]=Array.isArray(p)?p[0]:String(p)}),u(c)}else alert("Failed to save user")}finally{b(!1)}}};return j?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6 max-w-2xl",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>l("/admin/users"),className:"p-2 text-neutral-500 hover:text-neutral-700 hover:bg-neutral-100 dark:hover:bg-neutral-700 rounded-lg transition-colors",children:e.jsx(E,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-900 dark:text-white",children:n?"Edit User":"Add User"}),e.jsx("p",{className:"text-neutral-500",children:n?"Update user details":"Create a new user account"})]})]}),e.jsxs("form",{onSubmit:N,className:"bg-white dark:bg-neutral-800 rounded-xl shadow-soft p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:"Name *"}),e.jsx("input",{type:"text",name:"name",value:s.name,onChange:m,className:`input ${t.name?"border-red-500":""}`,placeholder:"Enter full name"}),t.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:"Email *"}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:m,className:`input ${t.email?"border-red-500":""}`,placeholder:"Enter email address"}),t.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.email})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:["Password ",n?"(leave blank to keep current)":"*"]}),e.jsx("input",{type:"password",name:"password",value:s.password,onChange:m,className:`input ${t.password?"border-red-500":""}`,placeholder:n?"••••••••":"Enter password"}),t.password&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.password})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:"Confirm Password"}),e.jsx("input",{type:"password",name:"password_confirmation",value:s.password_confirmation,onChange:m,className:`input ${t.password_confirmation?"border-red-500":""}`,placeholder:"Confirm password"}),t.password_confirmation&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.password_confirmation})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx("button",{type:"submit",disabled:w,className:"btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:w?"Saving...":n?"Update User":"Create User"}),e.jsx("button",{type:"button",onClick:()=>l("/admin/users"),className:"btn-outline flex-1",children:"Cancel"})]})]})]})};export{U as default};
